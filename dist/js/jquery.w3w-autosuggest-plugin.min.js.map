{"version":3,"sources":["jquery.w3w-autosuggest-plugin.min.js"],"names":["factory","define","amd","module","exports","root","jQuery","undefined","window","require","$","pluginName","AutoSuggest","element","options","this","_api_end_point","_name","_defaults","fn","w3wAddress","defaults","extend","init","prototype","buildWrappers","autoSuggest","validation","destroy","unbindEvents","$element","removeData","direction","wrapAll","logo","addClass","closest","prepend","after","attr","placeholder","bindEvents","off","callback","onComplete","call","twaPartialRegex","key","debug","console","log","alert","lang","css","validationTypingTimer","_self","counter","typeahead","input","minLength","compression","hint","emptyTemplate","dynamic","delay","maxItem","source","autosuggest","filter","item","displayKey","selectedCountry","country_filter","get","val","toLowerCase","length","country","results","display","template","query","join","ajax","m","exec","data","addr","format","count","focus","clip","multilingual","type","url","path","onSearch","node","onInit","selector","onResult","result","resultCount","text","onNavigateAfter","lis","a","event","words","onClickAfter","form","validate","nextAll","empty","hasClass","clearTimeout","clearValidationMark","removeClass","setTimeout","trigger","onCancel","noMatchingCountry","validator","addMethod","value","optional","replace","isSuccess","twaRegex","suggestions","find","i","innerText","dataType","success","response","hasOwnProperty","valid_country_error","valid_error","addClassRules","w3w_valid","typingTimer","doneTypingInterval","regex","onfocusout","onkeyup","doneTyping","test","valid","errorPlacement","error","valid_container","appendTo","siblings","each","typeaheadDelay"],"mappings":"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","file":"jquery.w3w-autosuggest-plugin.min.js","sourcesContent":["/*!\n * what3words autosuggest jQuery plugin\n * Copyright (C) 2017 what3words Limited\n * Licensed under the MIT license\n *\n * @author what3words\n * @version 1.3.0-0\n * @link https://github.com/what3words/jquery-plugin-w3w-autosuggest\n */\n!function(e){\"function\"==typeof define&&define.amd?define([\"jquery\"],e):\"object\"==typeof module&&module.exports?module.exports=function(t,n){return void 0===n&&(n=\"undefined\"!=typeof window?require(\"jquery\"):require(\"jquery\")(t)),e(n),n}:e(jQuery)}(function(e){\"use strict\";var t=\"w3wAddress\",n=function(n,o){this._api_end_point=\"https://api.what3words.com/v2/\",this.element=n,this._name=t,this._defaults=e.fn.w3wAddress.defaults,this.options=e.extend({},this._defaults,o),this.init()};e.extend(n.prototype,{init:function(){this.buildWrappers(),this.autoSuggest(),this.validation()},destroy:function(){this.unbindEvents(),this.$element.removeData()},buildWrappers:function(){var t=this.options.direction;e(this.element).wrapAll('<div class=\"typeahead__container '+t+'\"><div class=\"typeahead__field\"><span class=\"typeahead__query\"></span></div></div>'),this.options.logo&&(e(this.element).addClass(\"typeahead__padlogo\"),e(this.element).closest(\".typeahead__container\").prepend('<img class=\"typeahead__w3w-logo\" src=\"https://assets.prod.what3words.com/images/w3w_grid-logo.svg\" alt=\"w3w-logo\">')),this.options.validation&&e(this.element).closest(\".typeahead__container\").after('<div class=\"typeahead__w3w_validation\"></div>'),e(this.element).addClass(\"typeahead__w3w_valid\").attr(\"placeholder\",this.options.placeholder+\" \").attr(\"autocomplete\",\"off\").attr(\"dir\",\"auto\").attr(\"aria-invalid\",\"true\")},bindEvents:function(){},unbindEvents:function(){this.$element.off(\".\"+this._name)},callback:function(){var e=this.options.onComplete;\"function\"==typeof e&&e.call(this.element)},autoSuggest:function(){var t=/^(\\D{1,})\\.(\\D{1,})\\.(\\D{1,})$/i;\"\"===this.options.key&&this.options.debug?(console.log(\"No what3words API key found!\"),alert(\"A what3words API key is required to use the AutoSuggest plugin. Information on how to register for a key can be found in the README\")):this.options.debug&&console.log(\"what3words API key: \"+this.options.key),\"ar\"===this.options.lang&&e(this.element).css(\"direction\",\"rtl\");var n,o=this,i=0;e.typeahead({debug:!0,input:e(this.element),minLength:5,compression:!0,hint:!0,emptyTemplate:!1,dynamic:!0,delay:200,maxItem:20,source:{autosuggest:{filter:function(t,n){var a=null;return null!==o.options.country_filter&&(e(o.options.country_filter).get(0)?(a=e(o.options.country_filter).val(),a=\"string\"==typeof a?a.toLowerCase():null,\"string\"==typeof a&&2===a.length||(a=null)):\"string\"==typeof o.options.country_filter&&2===o.options.country_filter.length&&(a=o.options.country_filter.toLowerCase())),null!==a?(o.options.debug&&(console.log(\"w3wAddress country_filter: \"),console.log(e(o.options.country_filter)),console.log(\"Selected Country is: \"+a),console.log(\"#################################\")),t.country===a&&(i<o.options.results&&(i++,!0))):i<o.options.results?(i++,!0):void 0},display:[\"words\"],template:function(e,t){return['<div class=\"typeahead__list-inner\">','<span class=\"typeahead__twa-flag w3w-flags-{{country}}\">',\"</span>\",'<span class=\"typeahead__twa\">{{words}}</span>',\"<br>\",'<span class=\"typeahead__info\">',\"{{place}}\",\"</span>\",\"</div>\"].join(\"\\n\")},ajax:function(e){var n=t.exec(e);if(null!==n){var i={addr:\"{{query}}\",format:\"json\",key:o.options.key,count:o.options.count,display:\"full\"};\"undefined\"!=typeof o.options.lang&&o.options.lang&&(i.lang=o.options.lang),\"undefined\"!=typeof o.options.focus&&o.options.focus&&(i.focus=o.options.focus),\"undefined\"!=typeof o.options.clip&&o.options.clip&&(i.clip=o.options.clip),o.options.multilingual||\"undefined\"!=typeof i.lang||(i.lang=\"en\");var a=o.options.multilingual?\"autosuggest-ml\":\"autosuggest\";return{type:\"GET\",url:o._api_end_point+a,data:i,path:\"suggestions\"}}return!1}}},callback:{onSearch:function(t,n){i=0,e(o.element).attr(\"aria-invalid\",!0)},onInit:function(e){o.options.debug&&console.log(\"w3wAddress typeahead initiated on field: \"+e.selector)},onResult:function(e,t,n,i){if(\"\"!==t){var a=\"\";0===n.length?a='No results matching \"'+t+'\"':n.length>0&&n.length<i?a=\"Showing \"+n.length+\" of \"+i+' elements matching \"'+t+'\"':n.length>0&&(a=\"Showing \"+n.length+\" elements matching addr= \"+t+'\"'),a+=\", with lang=\"+o.options.lang,a+=\"undefined\"!=typeof o.options.focus?\", with focus=\"+o.options.focus:\", without focus\",o.options.debug&&console.log(a)}},onNavigateAfter:function(t,n,i,a,s,l){\"undefined\"==typeof a||\"undefined\"==typeof a.words?e(o.element).attr(\"aria-invalid\",!0):e(o.element).attr(\"aria-invalid\",!1)},onClickAfter:function(t,i,a,s){if(o.options.validation){var l=e(o.element).closest(\"form\");if(l.length&&l.length>0){l.validate().element(\".typeahead__w3w_valid\"),e(o.element).closest(\".typeahead__container\").nextAll(\".typeahead__w3w_validation\").empty(),e(o.element).closest(\".typeahead__query\").hasClass(\"valid\")||e(o.element).closest(\".typeahead__query\").addClass(\"valid\"),clearTimeout(n);var r=function(){e(o.element).closest(\".typeahead__query\").removeClass(\"valid\")};n=setTimeout(r,500)}}\"undefined\"==typeof a||\"undefined\"==typeof a.words?e(o.element).attr(\"aria-invalid\",!0):(e(o.element).attr(\"aria-invalid\",!1),\"undefined\"!=typeof a&&e(o.element).trigger(\"selection\",[a]))},onCancel:function(t,n){o.options.validation&&e(o.element).closest(\".typeahead__container\").nextAll(\".typeahead__w3w_validation\").empty(),e(o.element).attr(\"aria-invalid\",!0),e(o.element).trigger(\"cancel\")}}})},validation:function(){if(this.options.validation!==!1){this.options.debug&&console.log(\"Validating the w3wAddress field\");var t=!1,n=this;e.validator.addMethod(\"w3w_valid\",function(t,o){if(this.optional(o)||\"\"===t.replace(/ /g,\"\"))return!0;var i=!1,a=/^(\\D{3,})\\.(\\D{3,})\\.(\\D{3,})$/i,s=a.exec(t);if(null!==s){var l=e(o).closest(\".typeahead__container\").find(\"span.typeahead__twa\");if(\"undefined\"!=typeof l&&l.length>0)for(var r=0;r<l.length&&!i;r++)l[r].innerText===t&&(i=!0);i||e.ajax({url:n._api_end_point+\"forward\",type:\"GET\",data:{addr:t,key:n.options.key,format:\"json\"},dataType:\"json\",success:function(e){var t=e;t.hasOwnProperty(\"geometry\")&&(i=!0)}})}return i},function(){return t===!0?n.options.valid_country_error:n.options.valid_error}),e.validator.addClassRules(\"typeahead__w3w_valid\",{w3w_valid:!0});var o,i=500,a=/^(\\D{1,})\\.(\\D{1,})\\.(\\D{1,})$/i,s=e(this.element).closest(\"form\");s.length&&s.length>0&&s.validate({onfocusout:!1,onkeyup:function(t){if(e(t).hasClass(\"typeahead__w3w_valid\")){clearTimeout(o);var n=function(){e(t).closest(\".typeahead__query\").removeClass(\"valid\"),a.test(e(t).val())&&e(t).valid()};o=setTimeout(n,i)}},errorPlacement:function(e,t){var n=t.closest(\".typeahead__container\");e.appendTo(n.siblings(\".typeahead__w3w_validation\"))}})}}}),e.fn.w3wAddress=function(o){return this.each(function(){e.data(this,\"plugin_\"+t)||e.data(this,\"plugin_\"+t,new n(this,o))}),this},e.fn.w3wAddress.defaults={country_filter:null,key:\"\",debug:!1,count:50,results:3,logo:!0,lang:\"en\",focus:null,clip:null,multilingual:!0,direction:\"ltr\",placeholder:\"e.g. lock.spout.radar\",validation:!0,valid_error:\"Please enter a valid 3 word address.\",typeaheadDelay:300}});\n//# sourceMappingURL=jquery.w3w-autosuggest-plugin.min.js.map\n"]}