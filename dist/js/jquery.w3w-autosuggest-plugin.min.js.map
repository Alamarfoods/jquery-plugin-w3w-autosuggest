{"version":3,"sources":["jquery.w3w-autosuggest-plugin.min.js"],"names":["factory","define","amd","module","exports","root","jQuery","undefined","window","require","$","pluginName","AutoSuggest","element","options","this","_api_end_point","_name","_defaults","fn","w3wAddress","defaults","extend","init","prototype","buildWrappers","autoSuggest","validation","destroy","unbindEvents","$element","removeData","direction","wrapAll","closest","prepend","after","addClass","attr","placeholder","bindEvents","off","callback","onComplete","call","twaPartialRegex","key","debug","console","log","alert","lang","css","_self","counter","typeahead","input","minLength","compression","hint","emptyTemplate","dynamic","delay","maxItem","source","autosuggest","filter","item","displayKey","selectedCountry","country_filter","country","results","display","template","query","join","ajax","m","exec","data","addr","format","count","multilingual","type","url","path","onSearch","node","onInit","selector","onResult","result","resultCount","text","length","focus","onClickAfter","a","event","validate","nextAll","empty","hasClass","noMatch","validator","addMethod","value","optional","replace","isSuccess","twaRegex","async","dataType","success","response","hasOwnProperty","valid_country_error","valid_error","addClassRules","w3w_valid","typingTimer","doneTypingInterval","regex","onfocusout","onkeyup","clearTimeout","doneTyping","removeClass","test","val","valid","setTimeout","errorPlacement","error","valid_container","appendTo","siblings","each"],"mappings":"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","file":"jquery.w3w-autosuggest-plugin.min.js","sourcesContent":["!function(t){\"function\"==typeof define&&define.amd?define([\"jquery\"],t):\"object\"==typeof module&&module.exports?module.exports=function(e,n){return void 0===n&&(n=\"undefined\"!=typeof window?require(\"jquery\"):require(\"jquery\")(e)),t(n),n}:t(jQuery)}(function(t){\"use strict\";var e=\"w3wAddress\",n=function(n,o){this._api_end_point=\"https://api.what3words.com/v2/\",this.element=n,this._name=e,this._defaults=t.fn.w3wAddress.defaults,this.options=t.extend({},this._defaults,o),this.init()};t.extend(n.prototype,{init:function(){this.buildWrappers(),this.autoSuggest(),this.validation()},destroy:function(){this.unbindEvents(),this.$element.removeData()},buildWrappers:function(){var e=this.options.direction;t(this.element).wrapAll('<div class=\"typeahead__container '+e+'\"><div class=\"typeahead__field\"><span class=\"typeahead__query\"></span></div></div>'),t(this.element).closest(\".typeahead__container\").prepend('<img class=\"w3w-logo\" src=\"https://assets.prod.what3words.com/images/w3w_grid-logo.svg\" alt=\"w3w-logo\">').after('<div class=\"w3w__validation\"></div>'),t(this.element).addClass(\"w3w_valid\").attr(\"placeholder\",this.options.placeholder+\" \").attr(\"autocomplete\",\"off\").attr(\"dir\",\"auto\")},bindEvents:function(){},unbindEvents:function(){this.$element.off(\".\"+this._name)},callback:function(){var t=this.options.onComplete;\"function\"==typeof t&&t.call(this.element)},autoSuggest:function(){var e=/^(\\D{1,})\\.(\\D{1,})\\.(\\D{1,})$/i;\"\"===this.options.key&&this.options.debug?(console.log(\"No what3words API key found!\"),alert(\"A what3words API key is required to use the AutoSuggest plugin. Information on how to register for a key can be found in the README\")):this.options.debug&&console.log(\"what3words API key: \"+this.options.key),\"ar\"===this.options.lang&&t(this.element).css(\"direction\",\"rtl\");var n=this,o=0;t.typeahead({debug:!0,input:t(this.element),minLength:5,compression:!0,hint:!0,emptyTemplate:!1,dynamic:!0,delay:700,maxItem:20,source:{autosuggest:{filter:function(e,i){var s=n.options.country_filter;return null!==s?(n.options.debug&&(console.log(\"w3wAddress country_filter: \"),console.log(t(n.options.country_filter)),console.log(\"Selected Country is: \"+s),console.log(\"#################################\")),e.country===s&&(o<n.options.results&&(o++,!0))):o<n.options.results?(o++,!0):void 0},display:[\"words\"],template:function(t,e){return['<div class=\"list-inner\">','<span class=\"twa-flag w3w-flags-{{country}}\">',\"</span>\",'<span class=\"twa\">{{words}}</span>',\"<br>\",'<span class=\"info\">',\"{{place}}</span>\",\"</div>\"].join(\"\\n\")},ajax:function(t){var o=e.exec(t);if(null!==o){var i={addr:\"{{query}}\",format:\"json\",key:n.options.key,count:n.options.count,display:\"full\"};\"undefined\"!=typeof n.options.lang&&n.options.lang&&(i.lang=n.options.lang),n.options.multilingual||\"undefined\"!=typeof i.lang||(i.lang=\"en\");var s=n.options.multilingual?\"autosuggest-ml\":\"autosuggest\";return{type:\"GET\",url:n._api_end_point+s,data:i,path:\"suggestions\"}}return!1}}},callback:{onSearch:function(t,e){o=0},onInit:function(t){n.options.debug&&console.log(\"w3wAddress typeahead initiated on field: \"+t.selector)},onResult:function(t,e,o,i){if(\"\"!==e){var s=\"\";0===o.length?s='No results matching \"'+e+'\"':o.length>0&&o.length<i?s=\"Showing \"+o.length+\" of \"+i+' elements matching \"'+e+'\"':o.length>0&&(s=\"Showing \"+o.length+\" elements matching addr= \"+e+'\"'),s+=\", with lang=\"+n.options.lang,s+=\"undefined\"!=typeof n.options.focus?\", with focus=\"+n.options.focus:\", without focus\",n.options.debug&&console.log(s)}},onClickAfter:function(e,o,i,s){n.options.validation&&(t(n.element).closest(\"form\").validate().element(\".w3w_valid\"),t(n.element).closest(\".typeahead__container\").nextAll(\".w3w__validation\").empty(),t(n.element).closest(\".typeahead__query\").hasClass(\"valid\")||t(n.element).closest(\".typeahead__query\").addClass(\"valid\"))}}})},validation:function(){if(this.options.validation!==!1){this.options.debug&&console.log(\"Validating the w3wAddress field\");var e=!1,n=this;t.validator.addMethod(\"w3w_valid\",function(e,o){if(this.optional(o)||\"\"===e.replace(/ /g,\"\"))return!0;var i=!1,s=/^(\\D{3,})\\.(\\D{3,})\\.(\\D{3,})$/i,a=s.exec(e);return null!==a&&t.ajax({url:n._api_end_point+\"forward\",type:\"GET\",async:!1,data:{addr:e,key:n.options.key,format:\"json\"},dataType:\"json\",success:function(t){var e=t;e.hasOwnProperty(\"geometry\")&&(i=!0)}}),i},function(){return e===!0?n.options.valid_country_error:n.options.valid_error}),t.validator.addClassRules(\"w3w_valid\",{w3w_valid:!0});var o,i=500,s=/^(\\D{1,})\\.(\\D{1,})\\.(\\D{1,})$/i;t(this.element).closest(\"form\").validate({onfocusout:!1,onkeyup:function(e){if(t(e).hasClass(\"w3w_valid\")){clearTimeout(o);var n=function(){t(e).closest(\".typeahead__query\").removeClass(\"valid\"),s.test(t(e).val())&&t(e).valid()};o=setTimeout(n,i)}},errorPlacement:function(t,e){var n=e.closest(\".typeahead__container\");t.appendTo(n.siblings(\".w3w__validation\"))}})}}}),t.fn.w3wAddress=function(o){return this.each(function(){t.data(this,\"plugin_\"+e)||t.data(this,\"plugin_\"+e,new n(this,o))}),this},t.fn.w3wAddress.defaults={country_filter:null,key:\"\",debug:!1,count:50,results:3,lang:null,multilingual:!0,direction:\"ltr\",placeholder:\"e.g. lock.spout.radar\",validation:!0,validate:!0,valid_error:\"Please enter a valid 3 word address.\",path_to_flags:\"images/flags/\"}});\n//# sourceMappingURL=jquery.w3w-autosuggest-plugin.min.js.map\n"]}