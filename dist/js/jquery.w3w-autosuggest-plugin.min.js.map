{"version":3,"sources":["jquery.w3w-autosuggest-plugin.min.js"],"names":["factory","define","amd","module","exports","root","jQuery","undefined","window","require","$","AutoSuggest","element","options","this","_api_end_point","_name","_defaults","fn","w3wAddress","defaults","extend","init","prototype","buildWrappers","autoSuggest","validation","destroy","unbindEvents","$element","removeData","direction","wrapAll","logo","addClass","closest","prepend","after","attr","placeholder","bindEvents","off","callback","onComplete","call","twaPartialRegex","key","debug","console","log","alert","lang","css","hint","validationTypingTimer","_self","counter","typeahead","input","minLength","compression","emptyTemplate","dynamic","delay","typeaheadDelay","maxItem","source","autosuggest","filter","item","displayKey","selectedCountry","country_filter","get","val","toLowerCase","length","country","results","display","template","query","join","ajax","addr","indexOf","replace","exec","trigger","data","format","count","focus","clip","multilingual","type","url","path","onSearch","node","onInit","selector","onResult","result","resultCount","text","onNavigateAfter","lis","a","event","words","onClickAfter","form","validate","nextAll","empty","hasClass","clearTimeout","clearValidationMark","removeClass","setTimeout","onCancel","validator","addMethod","value","optional","isSuccess","suggestions","find","i","innerText","dataType","success","hasOwnProperty","valid_error","addClassRules","w3w_valid","typingTimer","regex","onfocusout","onkeyup","doneTyping","test","valid","errorPlacement","error","valid_container","appendTo","siblings","each"],"mappings":"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","file":"jquery.w3w-autosuggest-plugin.min.js","sourcesContent":["/*!\n * what3words autosuggest jQuery plugin\n * Copyright (C) 2017 what3words Limited\n * Licensed under the MIT license\n *\n * @author what3words\n * @version 1.3.1\n * @link https://github.com/what3words/jquery-plugin-w3w-autosuggest\n */\n!function(t){\"function\"==typeof define&&define.amd?define([\"jquery\"],t):\"object\"==typeof module&&module.exports?module.exports=function(e,n){return void 0===n&&(n=\"undefined\"!=typeof window?require(\"jquery\"):require(\"jquery\")(e)),t(n),n}:t(jQuery)}(function(t){\"use strict\";var e=function(e,n){this._api_end_point=\"https://api.what3words.com/v2/\",this.element=e,this._name=\"w3wAddress\",this._defaults=t.fn.w3wAddress.defaults,this.options=t.extend({},this._defaults,n),this.init()};t.extend(e.prototype,{init:function(){this.buildWrappers(),this.autoSuggest(),this.validation()},destroy:function(){this.unbindEvents(),this.$element.removeData()},buildWrappers:function(){var e=this.options.direction;t(this.element).wrapAll('<div class=\"typeahead__container '+e+'\"><div class=\"typeahead__field\"><span class=\"typeahead__query\"></span></div></div>'),this.options.logo&&(t(this.element).addClass(\"typeahead__padlogo\"),t(this.element).closest(\".typeahead__container\").prepend('<img class=\"typeahead__w3w-logo\" src=\"https://assets.what3words.com/images/w3w_grid-logo.svg\" alt=\"w3w-logo\">')),this.options.validation&&t(this.element).closest(\".typeahead__container\").after('<div class=\"typeahead__w3w_validation\"></div>'),t(this.element).addClass(\"typeahead__w3w_valid\").attr(\"placeholder\",this.options.placeholder+\" \").attr(\"autocomplete\",\"off\").attr(\"dir\",\"auto\").attr(\"aria-invalid\",\"true\")},bindEvents:function(){},unbindEvents:function(){this.$element.off(\".\"+this._name)},callback:function(){var t=this.options.onComplete;\"function\"==typeof t&&t.call(this.element)},autoSuggest:function(){var e=/^(\\D{1,})\\.(\\D{1,})\\.(\\D{1,})$/i;\"\"===this.options.key&&this.options.debug?(console.log(\"No what3words API key found!\"),alert(\"A what3words API key is required to use the AutoSuggest plugin. Information on how to register for a key can be found in the README\")):this.options.debug&&console.log(\"what3words API key: \"+this.options.key),\"ar\"===this.options.lang&&(t(this.element).css(\"direction\",\"rtl\"),this.options.hint=!1);var n,o=this,i=0;t.typeahead({debug:this.options.debug,input:t(this.element),minLength:5,compression:!0,hint:this.options.hint,emptyTemplate:!1,dynamic:!0,delay:this.options.typeaheadDelay,maxItem:20,source:{autosuggest:{filter:function(e,n){var a=null;return null!==o.options.country_filter&&(t(o.options.country_filter).get(0)?(a=t(o.options.country_filter).val(),\"string\"==typeof(a=\"string\"==typeof a?a.toLowerCase():null)&&2===a.length||(a=null)):\"string\"==typeof o.options.country_filter&&2===o.options.country_filter.length&&(a=o.options.country_filter.toLowerCase())),null!==a?(o.options.debug&&(console.log(\"w3wAddress country_filter: \"),console.log(t(o.options.country_filter)),console.log(\"Selected Country is: \"+a),console.log(\"#################################\")),e.country===a&&(i<o.options.results&&(i++,!0))):i<o.options.results?(i++,!0):void 0},display:[\"words\"],template:function(t,e){return['<div class=\"typeahead__list-inner\">','<span class=\"typeahead__twa-flag w3w-flags-{{country}}\">',\"</span>\",'<span class=\"typeahead__twa\">{{words}}</span>',\"<br>\",'<span class=\"typeahead__info\">',\"{{place}}\",\"</span>\",\"</div>\"].join(\"\\n\")},ajax:function(n){var i=n;if(0===i.indexOf(\"///\")&&(i=i.replace(/\\/\\/\\//,\"\")),null!==e.exec(i)){t(o.element).trigger(\"searched\",[n]);var a={addr:i,format:\"json\",key:o.options.key,count:o.options.count,display:\"full\"};void 0!==o.options.lang&&o.options.lang&&(a.lang=o.options.lang),void 0!==o.options.focus&&o.options.focus&&(a.focus=o.options.focus),void 0!==o.options.clip&&o.options.clip&&(a.clip=o.options.clip),o.options.multilingual||void 0!==a.lang||(a.lang=\"en\");var s=o.options.multilingual?\"autosuggest-ml\":\"autosuggest\";return{type:\"GET\",url:o._api_end_point+s,data:a,path:\"suggestions\"}}return!1}}},callback:{onSearch:function(e,n){i=0,t(o.element).attr(\"aria-invalid\",!0)},onInit:function(t){o.options.debug&&console.log(\"w3wAddress typeahead initiated on field: \"+t.selector)},onResult:function(t,e,n,i){if(\"\"!==e){var a=\"\";0===n.length?a='No results matching \"'+e+'\"':n.length>0&&n.length<i?a=\"Showing \"+n.length+\" of \"+i+' elements matching \"'+e+'\"':n.length>0&&(a=\"Showing \"+n.length+\" elements matching addr= \"+e+'\"'),a+=\", with lang=\"+o.options.lang,void 0!==o.options.focus?a+=\", with focus=\"+o.options.focus:a+=\", without focus\",o.options.debug&&console.log(a)}},onNavigateAfter:function(e,n,i,a,s,l){void 0===a||void 0===a.words?t(o.element).attr(\"aria-invalid\",!0):t(o.element).attr(\"aria-invalid\",!1)},onClickAfter:function(e,i,a,s){if(o.options.validation){var l=t(o.element).closest(\"form\");if(l.length&&l.length>0){l.validate().element(\".typeahead__w3w_valid\"),t(o.element).closest(\".typeahead__container\").nextAll(\".typeahead__w3w_validation\").empty(),t(o.element).closest(\".typeahead__query\").hasClass(\"valid\")||t(o.element).closest(\".typeahead__query\").addClass(\"valid\"),clearTimeout(n);var r=function(){t(o.element).closest(\".typeahead__query\").removeClass(\"valid\")};n=setTimeout(r,500)}}void 0===a||void 0===a.words?t(o.element).attr(\"aria-invalid\",!0):(t(o.element).attr(\"aria-invalid\",!1),void 0!==a&&t(o.element).trigger(\"selection\",[a]))},onCancel:function(e,n){o.options.validation&&t(o.element).closest(\".typeahead__container\").nextAll(\".typeahead__w3w_validation\").empty(),t(o.element).attr(\"aria-invalid\",!0),t(o.element).trigger(\"cancel\")}}})},validation:function(){if(!1!==this.options.validation){this.options.debug&&console.log(\"Validating the w3wAddress field\");var e=this;t.validator.addMethod(\"w3w_valid\",function(n,o){if(this.optional(o)||\"\"===n.replace(/ /g,\"\"))return!0;var i=!1;if(null!==/^(\\D{3,})\\.(\\D{3,})\\.(\\D{3,})$/i.exec(n)){var a=t(o).closest(\".typeahead__container\").find(\"span.typeahead__twa\");if(void 0!==a&&a.length>0)for(var s=0;s<a.length&&!i;s++)a[s].innerText===n&&(i=!0);i||t.ajax({url:e._api_end_point+\"forward\",type:\"GET\",data:{addr:n,key:e.options.key,format:\"json\"},dataType:\"json\",success:function(t){t.hasOwnProperty(\"geometry\")&&(i=!0)}})}return i},function(){return e.options.valid_error}),t.validator.addClassRules(\"typeahead__w3w_valid\",{w3w_valid:!0});var n,o=/^(\\D{1,})\\.(\\D{1,})\\.(\\D{1,})$/i,i=t(this.element).closest(\"form\");i.length&&i.length>0&&i.validate({onfocusout:!1,onkeyup:function(e){if(t(e).hasClass(\"typeahead__w3w_valid\")){clearTimeout(n);var i=function(){t(e).closest(\".typeahead__query\").removeClass(\"valid\"),o.test(t(e).val())&&t(e).valid()};n=setTimeout(i,500)}},errorPlacement:function(t,e){var n=e.closest(\".typeahead__container\");t.appendTo(n.siblings(\".typeahead__w3w_validation\"))}})}}}),t.fn.w3wAddress=function(n){return this.each(function(){t.data(this,\"plugin_w3wAddress\")||t.data(this,\"plugin_w3wAddress\",new e(this,n))}),this},t.fn.w3wAddress.defaults={country_filter:null,key:\"\",debug:!1,hint:!1,count:50,results:3,logo:!0,lang:\"en\",focus:null,clip:null,multilingual:!0,direction:\"ltr\",placeholder:\"e.g. lock.spout.radar\",validation:!0,valid_error:\"Please enter a valid 3 word address.\",typeaheadDelay:100}});\n//# sourceMappingURL=jquery.w3w-autosuggest-plugin.min.js.map\n"]}